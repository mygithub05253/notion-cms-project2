# Invoice Web MVP PRD

## 🎯 핵심 정보

**목적**: 노션에서 관리하는 견적서를 클라이언트가 웹으로 확인하고 PDF로 다운로드할 수 있는 플랫폼 제공

**사용자**: 견적서 발급자(관리자)와 견적서 수신자(클라이언트)

---

## 🚶 사용자 여정

```
1. 시작 페이지 (홈/로그인)
   ↓ [로그인 버튼 클릭]

2. 로그인 페이지
   ↓ [인증 성공]

   [관리자] → 3-1. 대시보드 (발급 관리)
   [클라이언트] → 3-2. 견적서 목록 페이지

3-1. 대시보드 (관리자 전용)
   ↓ [견적서 목록 조회]
   ├─ [상세 보기] → 4-1. 견적서 상세 페이지 (수정 가능)
   ├─ [삭제] → 대시보드 (목록 새로고침)
   └─ [발급] → 클라이언트에게 공유 가능한 URL 생성
   ↓ [로그아웃]

3-2. 견적서 목록 페이지 (클라이언트)
   ↓ [공유 URL로 접근]
   ↓ [견적서 선택]

4-1. 견적서 상세 페이지 (관리자 - 수정 모드)
   ├─ [내용 수정]
   ├─ [저장] → 대시보드로 이동
   ├─ [삭제] → 대시보드로 이동
   └─ [공유 링크 생성] → URL 복사 모달

4-2. 견적서 상세 페이지 (클라이언트 - 열람 모드)
   ├─ [내용 확인]
   ├─ [PDF 다운로드] → PDF 파일 생성 및 다운로드
   └─ [목록으로 돌아가기] → 견적서 목록 페이지
```

---

## ⚡ 기능 명세

### 1. MVP 핵심 기능

| ID | 기능명 | 설명 | MVP 필수 이유 | 관련 페이지 |
|----|--------|------|-------------|------------|
| **F001** | 관리자 인증 | 관리자 로그인/로그아웃 기능 | 서비스 보안의 최소 요건 | 로그인 페이지 |
| **F002** | 견적서 조회 | 관리자: 발급한 모든 견적서 목록 조회 | 관리 업무의 핵심 | 대시보드 페이지, 견적서 목록 페이지 |
| **F003** | 견적서 상세 조회 | 견적서의 모든 항목 및 금액 정보 표시 | 정보 확인의 핵심 | 견적서 상세 페이지 |
| **F004** | 견적서 생성 | 노션에서 입력한 견적서를 시스템에 연동 | 데이터 소스 통합 | 대시보드 페이지, 견적서 생성 페이지 |
| **F005** | 견적서 수정 | 발급된 견적서 내용 편집 (관리자만) | 유연한 견적 관리 | 견적서 상세 페이지 |
| **F006** | 견적서 삭제 | 발급된 견적서 삭제 (관리자만) | 견적서 관리의 완전성 | 견적서 상세 페이지, 대시보드 페이지 |
| **F007** | 공유 링크 생성 | 클라이언트가 접근할 수 있는 고유 공유 URL 생성 | 클라이언트 접근 통제 | 견적서 상세 페이지, 견적서 목록 페이지 |
| **F008** | 공유 링크 조회 | 고유 공유 링크로 견적서 열람 (인증 불필요) | 클라이언트 접근 경로 | 견적서 목록 페이지, 견적서 상세 페이지 |
| **F009** | PDF 다운로드 | 견적서를 PDF 형식으로 다운로드 | 문서화 및 보관 요구 | 견적서 상세 페이지 |

### 2. MVP 필수 지원 기능

| ID | 기능명 | 설명 | MVP 필수 이유 | 관련 페이지 |
|----|--------|------|-------------|------------|
| **F010** | 기본 폼 입력 | 견적서 제목, 설명, 항목 입력 폼 | 견적서 생성/수정의 필수 UI | 견적서 생성 페이지, 견적서 상세 페이지 |
| **F011** | 사용자 정보 관리 | 로그인한 사용자 정보 저장 및 조회 | 관리자 식별 및 권한 관리 | 로그인 페이지, 대시보드 페이지 |
| **F012** | 오류 처리 및 알림 | 사용자 친화적 에러 메시지 및 성공 알림 | 사용성 개선 | 모든 페이지 |

### 3. MVP 이후 기능 (제외)

- 고급 검색 및 필터링
- 클라이언트 회원가입 및 프로필 관리
- 견적서 서명 기능
- 결제 연동
- 이메일 자동 발송
- 실시간 알림 시스템
- 버전 관리 및 히스토리
- 권한별 접근 제어 (세부 권한)

---

## 📱 메뉴 구조

```
📱 Invoice Web 내비게이션

🏠 공개 페이지 (비인증)
├── 홈 (로그인 페이지)
│   └── 기능: F001 (관리자 인증)
└── 공개 공유 링크 접근
    ├── 견적서 목록 (공개)
    │   └── 기능: F008 (공유 링크 조회)
    └── 견적서 상세 (공개, 열람 전용)
        └── 기능: F003, F009 (조회, PDF 다운로드)

👤 관리자 메뉴 (로그인 후)
├── 대시보드
│   └── 기능: F002, F004, F006 (견적서 목록, 생성, 삭제)
├── 견적서 목록
│   └── 기능: F002 (모든 견적서 조회)
├── 견적서 상세
│   ├── 기능: F003 (상세 조회)
│   ├── 기능: F005 (수정)
│   ├── 기능: F007 (공유 링크 생성)
│   └── 기능: F006 (삭제)
└── 로그아웃
    └── 기능: F001 (인증 해제)
```

---

## 📄 페이지별 상세 기능

### 로그인 페이지

> **구현 기능:** `F001` | **메뉴 위치:** 홈 / 공개 진입점

| 항목 | 내용 |
|------|------|
| **역할** | 관리자 인증 및 시스템 접근 제어 |
| **진입 경로** | 앱 시작 시 자동으로 표시되는 첫 페이지 |
| **사용자 행동** | 관리자가 로그인 자격증명을 입력하여 인증 |
| **주요 기능** | • 이메일/사용자명 입력 필드<br>• 비밀번호 입력 필드<br>• 로그인 버튼<br>• 로그인 실패 시 에러 메시지 표시 |
| **다음 이동** | 성공 → 대시보드 페이지, 실패 → 에러 메시지 표시 후 현재 페이지 유지 |

---

### 대시보드 페이지

> **구현 기능:** `F002`, `F004`, `F006` | **메뉴 위치:** 관리자 > 대시보드 | **인증:** 관리자 필수

| 항목 | 내용 |
|------|------|
| **역할** | 관리자의 모든 견적서를 한눈에 관리하고 주요 작업(생성, 삭제)을 수행 |
| **진입 경로** | 로그인 성공 후 자동 리디렉션 또는 네비게이션 메뉴에서 대시보드 클릭 |
| **사용자 행동** | 발급된 견적서 목록을 보고, 새로운 견적서를 생성하거나 기존 견적서를 삭제 |
| **주요 기능** | • 견적서 목록 테이블 (제목, 생성일, 상태, 클라이언트 정보 등)<br>• 새 견적서 생성 버튼<br>• 각 견적서의 상세 보기 버튼<br>• 각 견적서의 삭제 버튼<br>• 삭제 시 확인 모달 표시<br>• 페이지네이션 (선택사항 MVP 이후) |
| **다음 이동** | 상세 보기 → 견적서 상세 페이지, 생성 → 견적서 생성 페이지, 삭제 → 목록 새로고침 |

---

### 견적서 생성 페이지

> **구현 기능:** `F004`, `F010` | **메뉴 위치:** 관리자 > 대시보드 (새 견적서 버튼) | **인증:** 관리자 필수

| 항목 | 내용 |
|------|------|
| **역할** | 새로운 견적서를 작성하고 시스템에 저장 |
| **진입 경로** | 대시보드 페이지의 "새 견적서 생성" 버튼 클릭 |
| **사용자 행동** | 견적서의 기본 정보(제목, 클라이언트 정보 등)와 항목(상품/서비스 명, 수량, 금액)을 입력하여 저장 |
| **주요 기능** | • 견적서 제목 입력 필드<br>• 클라이언트 이름 입력 필드<br>• 클라이언트 이메일 입력 필드<br>• 설명/메모 입력 필드<br>• 항목 추가 폼 (상품명, 수량, 단가, 소계)<br>• 항목 추가 버튼<br>• 항목 삭제 버튼<br>• 총액 자동 계산 표시<br>• 저장 버튼<br>• 취소 버튼 |
| **다음 이동** | 저장 성공 → 견적서 상세 페이지, 취소 → 대시보드 페이지 |

---

### 견적서 상세 페이지 (관리자 모드)

> **구현 기능:** `F003`, `F005`, `F006`, `F007` | **메뉴 위치:** 대시보드 > 상세 보기 또는 견적서 목록 | **인증:** 관리자 필수

| 항목 | 내용 |
|------|------|
| **역할** | 발급된 견적서를 열람하고 수정, 삭제, 공유할 수 있는 관리 중심 페이지 |
| **진입 경로** | 대시보드 페이지에서 상세 보기 버튼 클릭 또는 견적서 목록에서 클릭 |
| **사용자 행동** | 견적서 정보를 확인하고, 필요하면 수정하거나 클라이언트에게 공유할 수 있는 링크를 생성 |
| **주요 기능** | • 견적서 제목 표시 (수정 가능)<br>• 클라이언트 정보 표시 (수정 가능)<br>• 항목 목록 표시 (수정/삭제 가능)<br>• 새 항목 추가 기능<br>• 총액 자동 계산 표시<br>• 공유 링크 생성 버튼<br>• 공유 링크 복사 모달<br>• 저장 버튼<br>• 삭제 버튼 (확인 모달 포함)<br>• 돌아가기 버튼 |
| **다음 이동** | 저장 → 현재 페이지 업데이트, 삭제 → 대시보드 페이지, 돌아가기 → 대시보드 페이지 |

---

### 견적서 목록 페이지 (클라이언트 공개)

> **구현 기능:** `F002`, `F008` | **메뉴 위치:** 공개 공유 링크 (비인증 사용자) | **인증:** 공유 토큰 필수

| 항목 | 내용 |
|------|------|
| **역할** | 클라이언트가 공유된 견적서 목록을 확인하고 선택 |
| **진입 경로** | 공유 링크(예: `/invoices/share/[token]`) 클릭 또는 접근 |
| **사용자 행동** | 발급받은 견적서 목록을 보고 확인하고 싶은 견적서 선택 |
| **주요 기능** | • 견적서 목록 카드 형식 표시 (제목, 생성일, 상태)<br>• 각 견적서 클릭 시 상세 페이지 이동 |
| **다음 이동** | 견적서 선택 → 견적서 상세 페이지 (클라이언트 모드) |

---

### 견적서 상세 페이지 (클라이언트 공개)

> **구현 기능:** `F003`, `F009` | **메뉴 위치:** 공개 공유 링크 > 상세 페이지 | **인증:** 공유 토큰 필수

| 항목 | 내용 |
|------|------|
| **역할** | 클라이언트가 견적서 내용을 확인하고 PDF로 다운로드 |
| **진입 경로** | 견적서 목록 페이지에서 견적서 선택 또는 직접 공유 링크 접근 |
| **사용자 행동** | 견적서 정보를 확인하고 필요시 PDF로 다운로드 |
| **주요 기능** | • 견적서 제목 표시<br>• 클라이언트 정보 표시 (읽기 전용)<br>• 항목 목록 표시 (읽기 전용)<br>• 총액 표시<br>• PDF 다운로드 버튼<br>• 목록으로 돌아가기 버튼 (공개 목록이 있는 경우) |
| **다음 이동** | PDF 다운로드 → 파일 저장, 돌아가기 → 견적서 목록 페이지 |

---

## 🗄️ 데이터 모델

### User (사용자)

| 필드 | 설명 | 타입/관계 |
|------|------|----------|
| id | 고유 식별자 | UUID |
| email | 이메일 주소 | STRING (UNIQUE) |
| password | 해시된 비밀번호 | STRING |
| name | 사용자 이름 | STRING |
| role | 사용자 역할 | ENUM (admin, client) |
| createdAt | 생성 날짜 | TIMESTAMP |
| updatedAt | 수정 날짜 | TIMESTAMP |

### Invoice (견적서)

| 필드 | 설명 | 타입/관계 |
|------|------|----------|
| id | 고유 식별자 | UUID |
| title | 견적서 제목 | STRING |
| description | 견적서 설명 | TEXT (nullable) |
| createdBy | 발급한 관리자 | → User.id |
| clientName | 클라이언트 이름 | STRING |
| clientEmail | 클라이언트 이메일 | STRING (nullable) |
| status | 견적서 상태 | ENUM (draft, sent, accepted, rejected) |
| totalAmount | 총액 | DECIMAL |
| createdAt | 생성 날짜 | TIMESTAMP |
| updatedAt | 수정 날짜 | TIMESTAMP |

### InvoiceItem (견적서 항목)

| 필드 | 설명 | 타입/관계 |
|------|------|----------|
| id | 고유 식별자 | UUID |
| invoiceId | 소속 견적서 | → Invoice.id |
| description | 항목 설명 (상품/서비스명) | STRING |
| quantity | 수량 | INTEGER |
| unitPrice | 단가 | DECIMAL |
| subtotal | 소계 | DECIMAL |
| displayOrder | 표시 순서 | INTEGER |

### InvoiceShare (공유 링크)

| 필드 | 설명 | 타입/관계 |
|------|------|----------|
| id | 고유 식별자 | UUID |
| invoiceId | 공유되는 견적서 | → Invoice.id |
| token | 공유 토큰 (고유) | STRING (UNIQUE) |
| expiresAt | 만료 날짜 | TIMESTAMP (nullable) |
| createdAt | 생성 날짜 | TIMESTAMP |

---

## 🛠️ 기술 스택 (최신 버전)

### 프론트엔드 프레임워크

- **Next.js 15.1.1** (App Router) - React 풀스택 프레임워크, 최적화된 성능
- **TypeScript 5.6+** - 타입 안전성 보장, 엄격한 모드 사용
- **React 19.2.3** - 최신 UI 라이브러리, 동시성 기능 지원

### 스타일링 및 UI

- **Tailwind CSS v4** (설정 파일 없는 새로운 CSS 엔진) - 유틸리티 기반 스타일링
- **shadcn/ui** - 고품질 React 컴포넌트 라이브러리
- **Lucide React** - 아이콘 라이브러리

### 폼 및 검증

- **React Hook Form 7.69.0** - 효율적인 폼 상태 관리
- **Zod 4.3.4** - 스키마 검증 라이브러리

### 상태 관리

- **Zustand 5.0.9** - 가벼운 전역 상태 관리 라이브러리

### 유틸리티

- **date-fns 4.1.0** - 날짜 포맷팅 및 조작
- **Sonner 2.0.7** - 토스트 알림 라이브러리
- **usehooks-ts 3.1.1** - 커스텀 React 훅 컬렉션

### PDF 생성 및 다운로드

- **html2pdf** 또는 **jsPDF + html2canvas** - 견적서를 PDF로 변환하여 다운로드

### 데이터베이스 및 백엔드 (추후 결정)

- **Supabase** (권장) - BaaS (인증, PostgreSQL 데이터베이스, 실시간 기능)
- **또는 Node.js Express + PostgreSQL** - 자체 백엔드 구축

### 배포

- **Vercel** - Next.js 최적화 배포 플랫폼

### 패키지 관리

- **npm** - 의존성 관리

---

## 🏗️ 아키텍처 개요

### 디렉토리 구조

```
invoice-web/
├── app/                          # Next.js App Router
│   ├── layout.tsx               # 루트 레이아웃 (테마, 토스트 프로바이더)
│   ├── page.tsx                 # 홈 페이지 (로그인 페이지)
│   ├── login/                   # 로그인 페이지
│   │   └── page.tsx
│   └── (protected)/             # 인증이 필요한 라우트 그룹
│       ├── layout.tsx           # 대시보드 레이아웃 (네비게이션)
│       ├── dashboard/
│       │   └── page.tsx         # 대시보드
│       ├── invoices/
│       │   ├── page.tsx         # 견적서 목록 (관리자)
│       │   ├── [id]/            # 견적서 상세 페이지
│       │   │   └── page.tsx
│       │   └── new/
│       │       └── page.tsx     # 견적서 생성 페이지
│       └── share/               # 공개 공유 페이지
│           ├── [token]/         # 공유 토큰 기반 접근
│           │   ├── page.tsx     # 공개 견적서 목록
│           │   └── invoices/
│           │       └── [id]/page.tsx  # 공개 견적서 상세 (클라이언트)
│
├── components/
│   ├── ui/                      # shadcn/ui 컴포넌트
│   │   ├── button.tsx
│   │   ├── card.tsx
│   │   ├── dialog.tsx
│   │   ├── input.tsx
│   │   ├── label.tsx
│   │   ├── table.tsx
│   │   └── ...
│   ├── layout/                  # 레이아웃 컴포넌트
│   │   ├── header.tsx           # 헤더/네비게이션
│   │   ├── sidebar.tsx
│   │   └── footer.tsx
│   └── features/                # 기능별 컴포넌트
│       ├── invoice-form.tsx     # 견적서 입력 폼
│       ├── invoice-table.tsx    # 견적서 테이블
│       ├── invoice-detail.tsx   # 견적서 상세 정보
│       ├── invoice-pdf.tsx      # PDF 다운로드 컴포넌트
│       └── auth-provider.tsx    # 인증 프로바이더
│
├── lib/
│   ├── utils.ts                 # 유틸리티 함수 (cn 등)
│   ├── api.ts                   # API 클라이언트 함수
│   └── invoice-pdf.ts           # PDF 생성 로직
│
├── hooks/
│   ├── useAuth.ts               # 인증 훅
│   ├── useInvoice.ts            # 견적서 관련 훅
│   └── useLocalStorage.ts       # 로컬 스토리지 훅
│
├── store/
│   ├── useAuthStore.ts          # 인증 상태 (Zustand)
│   └── useInvoiceStore.ts       # 견적서 상태 (Zustand)
│
├── types/
│   └── index.ts                 # TypeScript 타입 정의
│
├── public/                      # 정적 자산
├── styles/
│   └── globals.css              # 글로벌 스타일
├── package.json
├── tsconfig.json
└── tailwind.config.ts
```

### 인증 흐름

1. 사용자가 로그인 페이지에서 자격증명 입력
2. API 호출로 인증 확인
3. 성공 시 토큰 저장 (localStorage 또는 쿠키)
4. Zustand 스토어에 사용자 정보 저장
5. 대시보드로 리디렉션
6. 보호된 페이지 접근 시 토큰 확인

### 공유 링크 흐름

1. 관리자가 견적서 상세 페이지에서 "공유 링크 생성" 클릭
2. 백엔드에서 고유한 토큰 생성 및 저장
3. 공유 URL 생성 (예: `https://example.com/share/[token]`)
4. 클라이언트가 URL 접근 시 토큰 검증
5. 토큰이 유효하면 해당 견적서 표시

### PDF 생성 흐름

1. 클라이언트가 견적서 상세 페이지에서 "PDF 다운로드" 클릭
2. 견적서 데이터를 바탕으로 HTML 렌더링
3. html2pdf 또는 jsPDF로 PDF 생성
4. 파일명과 함께 다운로드

---

## 📊 상태 관리 전략

### Zustand 스토어

**useAuthStore.ts** (인증 상태)
```typescript
- currentUser: User | null
- isAuthenticated: boolean
- login(email, password): Promise<void>
- logout(): void
- setCurrentUser(user): void
```

**useInvoiceStore.ts** (견적서 관련 상태)
```typescript
- invoices: Invoice[]
- selectedInvoice: Invoice | null
- isLoading: boolean
- error: string | null
- fetchInvoices(): Promise<void>
- setSelectedInvoice(invoice): void
- addInvoice(invoice): void
- updateInvoice(id, invoice): void
- deleteInvoice(id): void
```

---

## 📋 API 명세 (백엔드 요구사항)

### 인증 API

- `POST /api/auth/login` - 로그인
- `POST /api/auth/logout` - 로그아웃
- `GET /api/auth/me` - 현재 사용자 정보 조회

### 견적서 API

- `GET /api/invoices` - 견적서 목록 조회
- `GET /api/invoices/:id` - 견적서 상세 조회
- `POST /api/invoices` - 견적서 생성
- `PUT /api/invoices/:id` - 견적서 수정
- `DELETE /api/invoices/:id` - 견적서 삭제

### 공유 링크 API

- `POST /api/invoices/:id/share` - 공유 링크 생성
- `GET /api/share/:token` - 공유 토큰 검증 및 견적서 조회

---

## 개발 로드맵

### Phase 1: 기본 구조 및 인증 (1-2주)
- [x] 프로젝트 초기화 (Next.js 15 + shadcn/ui)
- [ ] 로그인 페이지 UI 구현
- [ ] 인증 로직 및 Zustand 스토어 구현
- [ ] 보호된 라우트 설정

### Phase 2: 견적서 관리 기능 (2-3주)
- [ ] 대시보드 페이지 구현
- [ ] 견적서 목록 테이블 구현
- [ ] 견적서 생성/수정 폼 구현
- [ ] 견적서 상세 페이지 구현
- [ ] 백엔드 API 연동

### Phase 3: 공유 및 PDF 기능 (1-2주)
- [ ] 공유 링크 생성 로직 구현
- [ ] 공개 견적서 목록/상세 페이지 구현
- [ ] PDF 다운로드 기능 구현
- [ ] 테스트 및 최적화

---

## ✅ 성공 지표

1. **기능 완성도**
   - 모든 MVP 기능 구현 완료
   - 버그 없는 사용자 여정

2. **사용성**
   - 로그인부터 PDF 다운로드까지 평균 2분 이내 완료 가능
   - 모든 페이지에서 오류 메시지가 명확하게 표시

3. **성능**
   - 페이지 로드 시간 < 2초
   - PDF 생성 시간 < 3초

4. **접근성**
   - 반응형 디자인으로 모바일/태블릿/데스크톱 지원
   - 키보드 네비게이션 지원

---

## 📝 개발 주의사항

1. **보안**
   - 모든 API 요청은 HTTPS 사용
   - 인증 토큰은 httpOnly 쿠키에 저장 권장
   - 공유 링크는 예측 불가능한 토큰 사용 (UUID)

2. **데이터 무결성**
   - 견적서 삭제 시 아카이빙 고려 (물리적 삭제 대신 soft delete)
   - 감사 로그 기록 (추후 기능)

3. **테스트**
   - 단위 테스트: 유틸리티 함수 및 비즈니스 로직
   - E2E 테스트: 전체 사용자 여정 (Playwright)

---

## 📞 연락처 및 문서

- **프로젝트 저장소**: 추후 결정
- **문서화**: README.md, API 문서, 개발 가이드 작성 필수
- **배포 환경**: Vercel (프로덕션), 로컬 개발 환경

---

**문서 작성 일시**: 2026년 1월 15일
**버전**: 1.0 (MVP)
